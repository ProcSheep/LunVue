用户管理接口文档
1. 获取所有用户数据
接口信息
接口名称: 获取所有用户数据
接口地址: GET /api/user/users
接口描述: 获取系统中所有用户的信息，支持分页和按角色筛选
请求参数
查询参数:
page (number, 可选): 页码，默认为1
limit (number, 可选): 每页数量，默认为10
role (string, 可选): 角色筛选，可选值为"user"或"admin"
请求示例

http
Apply
GET /api/user/users?page=1&limit=10&role=admin
响应格式
成功响应 (200)

json
Apply
{
  "success": true,
  "message": "获取用户数据成功",
  "data": [
    {
      "_id": "696c54ee4529ff469d3bb69d",
      "username": "admin",
      "score": 999,
      "role": "admin",
      "phone": "13800138000",
      "createdAt": "2026-01-18T09:00:00.000Z",
      "updatedAt": "2026-01-18T09:00:00.000Z"
    },
    {
      "_id": "696c6d1c30d5c3091d940b25",
      "username": "zw",
      "score": 190,
      "role": "user",
      "phone": "18955564419",
      "createdAt": "2026-01-18T05:18:20.948Z",
      "updatedAt": "2026-01-18T05:18:20.948Z"
    }
  ],
  "pagination": {
    "currentPage": 1,
    "totalPages": 1,
    "totalUsers": 2,
    "limit": 10
  }
}
错误响应
服务器内部错误 (500):

json
Apply
{
  "success": false,
  "message": "获取用户数据失败: 具体错误信息"
}
2. 更新用户角色
接口信息
接口名称: 更新用户角色
接口地址: PUT /api/user/users/:user_id/role
接口描述: 更新指定用户的权限角色
请求参数
路径参数:
user_id (string): 用户唯一标识符，必需参数
请求体参数:
role (string): 新的角色值，必需参数，可选值为"user"或"admin"
请求示例

http
Apply
PUT /api/user/users/696c54ee4529ff469d3bb69d/role
Content-Type: application/json

{
  "role": "admin"
}
响应格式
成功响应 (200)

json
Apply
{
  "success": true,
  "message": "用户角色更新成功",
  "data": {
    "_id": "696c54ee4529ff469d3bb69d",
    "username": "admin",
    "password": "$2a$10$...",
    "score": 999,
    "role": "admin",
    "phone": "13800138000",
    "createdAt": "2026-01-18T09:00:00.000Z",
    "updatedAt": "2026-01-18T10:30:00.000Z"
  }
}
错误响应
参数缺失错误 (400):

json
Apply
{
  "success": false,
  "message": "用户ID不能为空"
}
无效角色错误 (400):

json
Apply
{
  "success": false,
  "message": "角色值无效，只能是 'user' 或 'admin'"
}
服务器内部错误 (500):

json
Apply
{
  "success": false,
  "message": "用户角色更新失败: 具体错误信息"
}
3. 获取单个用户信息
接口信息
接口名称: 获取单个用户信息
接口地址: GET /api/user/users/:user_id
接口描述: 获取指定用户的详细信息
请求参数
路径参数:
user_id (string): 用户唯一标识符，必需参数
请求示例

http
Apply
GET /api/user/users/696c54ee4529ff469d3bb69d
响应格式
成功响应 (200)

json
Apply
{
  "success": true,
  "message": "获取用户信息成功",
  "data": {
    "_id": "696c54ee4529ff469d3bb69d",
    "username": "admin",
    "score": 999,
    "role": "admin",
    "phone": "13800138000",
    "createdAt": "2026-01-18T09:00:00.000Z",
    "updatedAt": "2026-01-18T09:00:00.000Z"
  }
}
错误响应
参数缺失错误 (400):

json
Apply
{
  "success": false,
  "message": "用户ID不能为空"
}
用户不存在错误 (404):

json
Apply
{
  "success": false,
  "message": "用户不存在"
}
服务器内部错误 (500):

json
Apply
{
  "success": false,
  "message": "获取用户信息失败: 具体错误信息"
}
Vue前端使用示例

javascript
Apply
// 获取所有用户数据
async getAllUsers(page = 1, limit = 10, role = null) {
  try {
    let url = `/api/user/users?page=${page}&limit=${limit}`;
    if (role) {
      url += `&role=${role}`;
    }
    
    const response = await fetch(url, {
      method: 'GET',
      headers: {
        'Content-Type': 'application/json',
      },
    });

    const result = await response.json();

    if (result.success) {
      console.log('获取用户数据成功:', result.data);
      return result.data;
    } else {
      console.error('获取用户数据失败:', result.message);
      return null;
    }
  } catch (error) {
    console.error('请求失败:', error);
    return null;
  }
}

// 更新用户角色
async updateUserRole(userId, newRole) {
  try {
    const response = await fetch(`/api/user/users/${userId}/role`, {
      method: 'PUT',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        role: newRole
      }),
    });

    const result = await response.json();

    if (result.success) {
      console.log('用户角色更新成功:', result.data);
      return result.data;
    } else {
      console.error('用户角色更新失败:', result.message);
      return null;
    }
  } catch (error) {
    console.error('请求失败:', error);
    return null;
  }
}

// 获取单个用户信息
async getUserById(userId) {
  try {
    const response = await fetch(`/api/user/users/${userId}`, {
      method: 'GET',
      headers: {
        'Content-Type': 'application/json',
      },
    });

    const result = await response.json();

    if (result.success) {
      console.log('获取用户信息成功:', result.data);
      return result.data;
    } else {
      console.error('获取用户信息失败:', result.message);
      return null;
    }
  } catch (error) {
    console.error('请求失败:', error);
    return null;
  }
}

// 使用示例
getAllUsers(1, 20); // 获取第一页，每页20条用户数据
updateUserRole('696c54ee4529ff469d3bb69d', 'admin'); // 将用户设为管理员
getUserById('696c54ee4529ff469d3bb69d'); // 获取指定用户信息
注意事项
这些接口通常需要管理员权限才能访问，建议在实际部署时添加身份验证中间件
密码字段在返回的用户数据中会被排除，以保护用户隐私
更新用户角色时，角色值只能是 "user" 或 "admin"
接口支持分页查询，便于处理大量用户数据
所有接口都包含完整的错误处理机制